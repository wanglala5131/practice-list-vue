{"version":3,"sources":["webpack:///./src/views/CreateItem.vue?94bd","webpack:///src/views/CreateItem.vue","webpack:///./src/views/CreateItem.vue?15ba","webpack:///./src/views/CreateItem.vue","webpack:///./src/views/CreateItem.vue?38e3","webpack:///./src/components/CardForm.vue?7b1d","webpack:///src/components/CardForm.vue","webpack:///./src/components/CardForm.vue?f110","webpack:///./src/components/CardForm.vue","webpack:///./src/components/CardForm.vue?209b"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","isProcessing","on","$event","categories","subcategories","isLoading","submitFileHandler","_v","staticRenderFns","name","components","BackgroundImg","CardForm","data","subcategoryFilter","item","limit","description","image","CategoryId","subCategories","subcategoriesArr","created","fetchCategories","methods","component","staticClass","stopPropagation","preventDefault","submitFile","_t","opacity","directives","rawName","value","expression","domProps","target","composing","$set","$$selectedVal","Array","prototype","filter","call","options","o","selected","map","val","_value","multiple","filterSubcategory","_l","category","key","id","_s","subcategory","labelIndex","isArray","_i","$$a","$$el","$$c","checked","$$v","$$i","concat","slice","ref","fileChangeHandler","deleteImage","_e","oriImage","undefined","props","oriCategories","type","oriSubcategories","oriItem","Object","Boolean","formTtpe","String","filetype","includes","files","icon","title","$refs","inputFile","length","imageURL","confirmButtonText","result","isConfirmed","watch","newValue"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,OAAO,CAACA,EAAG,iBAAiBA,EAAG,MAAM,CAACA,EAAG,UAAU,CAACE,MAAM,CAAC,OAASN,EAAIO,cAAcC,GAAG,CAAC,gBAAgB,SAASC,GAAQT,EAAIO,aAAaE,OAAY,GAAGL,EAAG,WAAW,CAACE,MAAM,CAAC,iBAAiBN,EAAIU,WAAW,oBAAoBV,EAAIW,cAAc,aAAaX,EAAIY,UAAU,gBAAgBZ,EAAIO,cAAcC,GAAG,CAAC,WAAaR,EAAIa,oBAAoB,CAACb,EAAIc,GAAG,WAAW,IAC/cC,EAAkB,G,oFCsBtB,GACEC,KAAM,aACNC,WAAY,CACVC,cAAJ,OACIC,SAAJ,QAEEC,KANF,WAOI,MAAO,CACLb,cAAc,EACdK,WAAW,EACXF,WAAY,GACZC,cAAe,GACfU,kBAAmB,GACnBC,KAAM,CACJN,KAAM,GACNO,MAAO,GACPC,YAAa,GACbC,MAAO,GACPC,YAAa,EACbC,cAAe,GACfC,iBAAkB,MAIxBC,QAxBF,WAyBI5B,KAAK6B,mBAEPC,QAAS,CACP,gBADJ,WACA,2LAEA,wBAFA,mBAEA,EAFA,EAEA,OAFA,EAEA,WACA,SAHA,sBAIA,UAJA,OAMA,0BACA,gCACA,eARA,qDAUA,aACA,aACA,gCAZA,6DAgBI,kBAjBJ,SAiBA,qLAEA,kBAFA,SAGA,6BAHA,mBAGA,EAHA,EAGA,OAHA,EAGA,WACA,SAJA,sBAKA,UALA,UAOA,mBAPA,wBAQA,aACA,aACA,kBAEA,kBAZA,2BAeA,aACA,eACA,iBAEA,+CAnBA,qDAqBA,kBACA,aACA,aACA,2BAxBA,+DCnEoV,I,wBCQhVC,EAAY,eACd,EACAjC,EACAgB,GACA,EACA,KACA,WACA,MAIa,aAAAiB,E,sECnBf,yBAAuiB,EAAG,G,kCCA1iB,IAAIjC,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAAC6B,YAAY,iCAAiC,CAAC7B,EAAG,OAAO,CAAC6B,YAAY,YAAYzB,GAAG,CAAC,OAAS,SAASC,GAAyD,OAAjDA,EAAOyB,kBAAkBzB,EAAO0B,iBAAwBnC,EAAIoC,WAAW3B,MAAW,CAACL,EAAG,KAAK,CAAC6B,YAAY,cAAc,CAACjC,EAAIqC,GAAG,YAAY,GAAGjC,EAAG,MAAM,CAACA,EAAG,UAAU,CAACE,MAAM,CAAC,GAAK,cAAc,OAASN,EAAIY,UAAU,cAAa,EAAK,QAAUZ,EAAIsC,SAAS9B,GAAG,CAAC,gBAAgB,SAASC,GAAQT,EAAIY,UAAUH,OAAY,GAAGL,EAAG,MAAM,CAACmC,WAAW,CAAC,CAACvB,KAAK,OAAOwB,QAAQ,SAASC,OAAQzC,EAAIY,UAAW8B,WAAW,eAAeT,YAAY,gBAAgB,CAAC7B,EAAG,MAAM,CAAC6B,YAAY,uBAAuB,CAAC7B,EAAG,QAAQ,CAACE,MAAM,CAAC,IAAM,SAAS,CAACN,EAAIc,GAAG,YAAYV,EAAG,QAAQ,CAACmC,WAAW,CAAC,CAACvB,KAAK,QAAQwB,QAAQ,UAAUC,MAAOzC,EAAIsB,KAAS,KAAEoB,WAAW,cAAcpC,MAAM,CAAC,KAAO,OAAO,KAAO,OAAO,GAAK,OAAO,SAAW,IAAIqC,SAAS,CAAC,MAAS3C,EAAIsB,KAAS,MAAGd,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOmC,OAAOC,WAAqB7C,EAAI8C,KAAK9C,EAAIsB,KAAM,OAAQb,EAAOmC,OAAOH,aAAarC,EAAG,MAAM,CAAC6B,YAAY,2BAA2B,CAAC7B,EAAG,QAAQ,CAACE,MAAM,CAAC,IAAM,aAAa,CAACN,EAAIc,GAAG,YAAYV,EAAG,SAAS,CAACmC,WAAW,CAAC,CAACvB,KAAK,QAAQwB,QAAQ,UAAUC,MAAOzC,EAAIsB,KAAe,WAAEoB,WAAW,oBAAoBT,YAAY,WAAW3B,MAAM,CAAC,KAAO,aAAa,GAAK,WAAW,SAAW,IAAIE,GAAG,CAAC,OAAS,CAAC,SAASC,GAAQ,IAAIsC,EAAgBC,MAAMC,UAAUC,OAAOC,KAAK1C,EAAOmC,OAAOQ,SAAQ,SAASC,GAAG,OAAOA,EAAEC,YAAWC,KAAI,SAASF,GAAG,IAAIG,EAAM,WAAYH,EAAIA,EAAEI,OAASJ,EAAEZ,MAAM,OAAOe,KAAOxD,EAAI8C,KAAK9C,EAAIsB,KAAM,aAAcb,EAAOmC,OAAOc,SAAWX,EAAgBA,EAAc,KAAK/C,EAAI2D,qBAAqB,CAACvD,EAAG,SAAS,CAACE,MAAM,CAAC,MAAQ,KAAK,OAAS,GAAG,SAAW,KAAK,CAACN,EAAIc,GAAG,SAASd,EAAI4D,GAAI5D,EAAc,YAAE,SAAS6D,GAAU,OAAOzD,EAAG,SAAS,CAAC0D,IAAID,EAASE,GAAGpB,SAAS,CAAC,MAAQkB,EAASE,KAAK,CAAC/D,EAAIc,GAAGd,EAAIgE,GAAGH,EAAS7C,aAAY,KAAKZ,EAAG,MAAM,CAAC6B,YAAY,8BAA8B,CAAC7B,EAAG,IAAI,CAACJ,EAAIc,GAAG,YAAYV,EAAG,MAAM,CAAC6B,YAAY,4BAA4BjC,EAAI4D,GAAI5D,EAAqB,mBAAE,SAASiE,GAAa,OAAO7D,EAAG,MAAM,CAAC0D,IAAIG,EAAYF,GAAG9B,YAAY,mBAAmB,CAAC7B,EAAG,QAAQ,CAACmC,WAAW,CAAC,CAACvB,KAAK,QAAQwB,QAAQ,UAAUC,MAAOzC,EAAIsB,KAAqB,iBAAEoB,WAAW,0BAA0BpC,MAAM,CAAC,KAAO,WAAW,GAAKN,EAAIkE,WAAWD,EAAYF,IAAI,KAAO,oBAAoBpB,SAAS,CAAC,MAAQsB,EAAYF,GAAG,QAAUf,MAAMmB,QAAQnE,EAAIsB,KAAKM,kBAAkB5B,EAAIoE,GAAGpE,EAAIsB,KAAKM,iBAAiBqC,EAAYF,KAAK,EAAG/D,EAAIsB,KAAqB,kBAAGd,GAAG,CAAC,OAAS,SAASC,GAAQ,IAAI4D,EAAIrE,EAAIsB,KAAKM,iBAAiB0C,EAAK7D,EAAOmC,OAAO2B,IAAID,EAAKE,QAAuB,GAAGxB,MAAMmB,QAAQE,GAAK,CAAC,IAAII,EAAIR,EAAYF,GAAGW,EAAI1E,EAAIoE,GAAGC,EAAII,GAAQH,EAAKE,QAASE,EAAI,GAAI1E,EAAI8C,KAAK9C,EAAIsB,KAAM,mBAAoB+C,EAAIM,OAAO,CAACF,KAAaC,GAAK,GAAI1E,EAAI8C,KAAK9C,EAAIsB,KAAM,mBAAoB+C,EAAIO,MAAM,EAAEF,GAAKC,OAAON,EAAIO,MAAMF,EAAI,UAAY1E,EAAI8C,KAAK9C,EAAIsB,KAAM,mBAAoBiD,OAAUnE,EAAG,QAAQ,CAACE,MAAM,CAAC,IAAMN,EAAIkE,WAAWD,EAAYF,MAAM,CAAC/D,EAAIc,GAAGd,EAAIgE,GAAGC,EAAYjD,cAAa,KAAKZ,EAAG,MAAM,CAAC6B,YAAY,wBAAwB,CAAC7B,EAAG,QAAQ,CAACE,MAAM,CAAC,IAAM,UAAU,CAACN,EAAIc,GAAG,SAASV,EAAG,QAAQ,CAACmC,WAAW,CAAC,CAACvB,KAAK,QAAQwB,QAAQ,UAAUC,MAAOzC,EAAIsB,KAAU,MAAEoB,WAAW,eAAepC,MAAM,CAAC,KAAO,OAAO,KAAO,QAAQ,GAAK,SAASqC,SAAS,CAAC,MAAS3C,EAAIsB,KAAU,OAAGd,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOmC,OAAOC,WAAqB7C,EAAI8C,KAAK9C,EAAIsB,KAAM,QAASb,EAAOmC,OAAOH,aAAarC,EAAG,MAAM,CAAC6B,YAAY,8BAA8B,CAAC7B,EAAG,QAAQ,CAACE,MAAM,CAAC,IAAM,gBAAgB,CAACN,EAAIc,GAAG,WAAWV,EAAG,WAAW,CAACmC,WAAW,CAAC,CAACvB,KAAK,QAAQwB,QAAQ,UAAUC,MAAOzC,EAAIsB,KAAgB,YAAEoB,WAAW,qBAAqBpC,MAAM,CAAC,KAAO,cAAc,GAAK,eAAeqC,SAAS,CAAC,MAAS3C,EAAIsB,KAAgB,aAAGd,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOmC,OAAOC,WAAqB7C,EAAI8C,KAAK9C,EAAIsB,KAAM,cAAeb,EAAOmC,OAAOH,aAAarC,EAAG,MAAM,CAAC6B,YAAY,wBAAwB,CAAC7B,EAAG,IAAI,CAACE,MAAM,CAAC,IAAM,UAAU,CAACN,EAAIc,GAAG,WAAWV,EAAG,QAAQ,CAACyE,IAAI,YAAYvE,MAAM,CAAC,KAAO,OAAO,KAAO,SAASE,GAAG,CAAC,OAASR,EAAI8E,qBAAqB1E,EAAG,MAAM,CAAC6B,YAAY,mBAAmB,CAAC7B,EAAG,MAAM,CAACmC,WAAW,CAAC,CAACvB,KAAK,OAAOwB,QAAQ,SAASC,MAAOzC,EAAIsB,KAAU,MAAEoB,WAAW,eAAepC,MAAM,CAAC,IAAMN,EAAIsB,KAAKG,MAAM,IAAM,iBAAiBrB,EAAG,MAAM,CAACmC,WAAW,CAAC,CAACvB,KAAK,OAAOwB,QAAQ,SAASC,OAAQzC,EAAIY,UAAW8B,WAAW,eAAeT,YAAY,gBAAgB,CAAC7B,EAAG,cAAc,CAAC6B,YAAY,6BAA6B3B,MAAM,CAAC,GAAK,MAAM,CAACN,EAAIc,GAAG,WAAYd,EAAY,SAAEI,EAAG,SAAS,CAAC6B,YAAY,kCAAkCzB,GAAG,CAAC,MAAQ,SAASC,GAAyD,OAAjDA,EAAOyB,kBAAkBzB,EAAO0B,iBAAwBnC,EAAI+E,YAAY/E,EAAIsB,KAAKyC,OAAO,CAAC/D,EAAIc,GAAG,aAAad,EAAIgF,KAAK5E,EAAG,SAAS,CAAC6B,YAAY,iCAAiC3B,MAAM,CAAC,KAAO,SAAS,SAAWN,EAAIO,eAAe,CAACP,EAAIc,GAAG,IAAId,EAAIgE,GAAGhE,EAAIO,aAAe,MAAQ,QAAQ,QAAQ,QAC/2JQ,EAAkB,G,sHCmHtB,GACEC,KAAM,WACNI,KAFF,WAGI,MAAO,CACLkB,QAAS,EACTjB,kBAAmB,GACnBC,KAAM,CACJG,MAAO,GACPC,YAAa,GAEfuD,cAAUC,EACVxE,WAAY,GACZC,cAAe,KAGnBwE,MAAO,CACLC,cAAe,CACbC,KAAMrC,OAERsC,iBAAkB,CAChBD,KAAMrC,OAERuC,QAAS,CACPF,KAAMG,QAERjF,aAAc,CACZ8E,KAAMI,SAER7E,UAAW,CACTyE,KAAMI,SAERC,SAAU,CACRL,KAAMM,SAGV5D,QAAS,CACP4B,kBADJ,WACA,WACM1D,KAAKqB,KAAKM,iBAAmB,GAC7B3B,KAAKoB,kBAAoBpB,KAAKU,cAAcuC,QAClD,YAAQ,OAAR,qCAGIgB,WAPJ,SAOA,GACM,MAAO,eAAb,WAEIY,kBAVJ,SAUA,GACM,IAAN,iBACA,6BACM,IAAKc,EAASC,SAASC,EAAM,GAAGT,MAO9B,OANA,EAAR,WACUU,KAAM,QACNC,MAAO,YAET/F,KAAKqB,KAAKG,MAAQ,QAClBxB,KAAKgG,MAAMC,UAAUzD,MAAQ,IAG/B,GAAKqD,EAAMK,OAEjB,CACQ,IAAR,mCACQlG,KAAKqB,KAAKG,MAAQ2E,OAHlBnG,KAAKqB,KAAKG,MAAQ,IAMtBW,WA7BJ,SA6BA,cACM,IACN,gBACA,wBACA,sCAEQ,EAAR,WACU2D,KAAM,QACNC,MAAO,mBAPX,CAWA,IAAN,WACA,kBACM,EAAN,WACQA,MAAO,2BACPK,kBAAmB,OAC3B,kBACYC,EAAOC,aACT,EAAV,2BAKI,YArDJ,SAqDA,gMAEA,aACA,kBACA,yBAJA,UAEA,EAFA,QAMA,cANA,iCAOA,wBACA,WARA,mBAOA,EAPA,EAOA,OAPA,EAOA,WAGA,SAVA,uBAWA,UAXA,WAaA,mBAbA,wBAcA,aACA,aACA,kBAhBA,2BAoBA,aACA,eACA,kBAEA,oCAxBA,6DA2BA,aACA,aACA,yBA7BA,8DAkCEC,MAAO,CACLpB,cADJ,SACA,GACMnF,KAAKS,WAAa+F,GAEpBnB,iBAJJ,SAIA,cACMrF,KAAKU,cAAgB8F,EAEiB,IAAlCxG,KAAKoB,kBAAkB8E,SAA0C,IAA1BlG,KAAKqB,KAAKI,aACnDzB,KAAKoB,kBAAoBoF,EAASvD,QAC1C,YAAU,OAAV,yCAIIqC,QAbJ,SAaA,cACMtF,KAAKqB,KAAOmF,EACZxG,KAAKgF,SAAWwB,EAAShF,MAG/B,mCACA,gCAEQxB,KAAKoB,kBAAoBpB,KAAKU,cAAcuC,QACpD,YAAU,OAAV,2CCpQkV,I,wBCQ9UlB,EAAY,eACd,EACAjC,EACAgB,GACA,EACA,KACA,KACA,MAIa,OAAAiB,E,kECnBf,yBAA6gB,EAAG","file":"js/chunk-16086b90.c9f4df07.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('main',[_c('BackgroundImg'),_c('div',[_c('loading',{attrs:{\"active\":_vm.isProcessing},on:{\"update:active\":function($event){_vm.isProcessing=$event}}})],1),_c('CardForm',{attrs:{\"ori-categories\":_vm.categories,\"ori-subcategories\":_vm.subcategories,\"is-loading\":_vm.isLoading,\"is-processing\":_vm.isProcessing},on:{\"submitFile\":_vm.submitFileHandler}},[_vm._v(\"新增項目\")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <main>\r\n    <BackgroundImg />\r\n    <div>\r\n      <loading :active.sync=\"isProcessing\"></loading>\r\n    </div>\r\n    <CardForm\r\n      :ori-categories=\"categories\"\r\n      :ori-subcategories=\"subcategories\"\r\n      :is-loading=\"isLoading\"\r\n      :is-processing=\"isProcessing\"\r\n      @submitFile=\"submitFileHandler\"\r\n      >新增項目</CardForm\r\n    >\r\n  </main>\r\n</template>\r\n\r\n<script>\r\nimport BackgroundImg from '../components/BackgroundImg'\r\nimport CardForm from '../components/CardForm'\r\nimport settingAPI from '../apis/setting'\r\nimport itemsAPI from '../apis/items'\r\nimport { Toast } from '../utils/helpers'\r\nexport default {\r\n  name: 'CreateItem',\r\n  components: {\r\n    BackgroundImg,\r\n    CardForm\r\n  },\r\n  data() {\r\n    return {\r\n      isProcessing: false,\r\n      isLoading: true,\r\n      categories: [],\r\n      subcategories: [],\r\n      subcategoryFilter: [],\r\n      item: {\r\n        name: '',\r\n        limit: '',\r\n        description: '',\r\n        image: '',\r\n        CategoryId: -1,\r\n        subCategories: [],\r\n        subcategoriesArr: []\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.fetchCategories()\r\n  },\r\n  methods: {\r\n    async fetchCategories() {\r\n      try {\r\n        const { data, statusText } = await settingAPI.getSubcategory()\r\n        if (statusText !== 'OK') {\r\n          throw new Error()\r\n        }\r\n        this.categories = data.categories\r\n        this.subcategories = data.subcategories\r\n        this.isLoading = false\r\n      } catch (err) {\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '目前無法取得運動項目與運動類別，請稍後再試'\r\n        })\r\n      }\r\n    },\r\n    async submitFileHandler(formData) {\r\n      try {\r\n        this.isProcessing = true\r\n        const { data, statusText } = await itemsAPI.addItem({ formData })\r\n        if (statusText !== 'OK') {\r\n          throw new Error()\r\n        }\r\n        if (data.status === 'error') {\r\n          Toast.fire({\r\n            icon: 'error',\r\n            title: data.message\r\n          })\r\n          this.isProcessing = false\r\n          return\r\n        }\r\n        Toast.fire({\r\n          icon: 'success',\r\n          title: '成功建立項目'\r\n        })\r\n        this.$router.push(`/items/${data.newItem.id}`)\r\n      } catch (err) {\r\n        this.isProcessing = false\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '目前暫時無法新增項目，請稍後再試'\r\n        })\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.bg-img {\r\n  display: none;\r\n  @include pad {\r\n    display: block;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CreateItem.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CreateItem.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CreateItem.vue?vue&type=template&id=68dfe150&scoped=true&\"\nimport script from \"./CreateItem.vue?vue&type=script&lang=js&\"\nexport * from \"./CreateItem.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CreateItem.vue?vue&type=style&index=0&id=68dfe150&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"68dfe150\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CreateItem.vue?vue&type=style&index=0&id=68dfe150&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CreateItem.vue?vue&type=style&index=0&id=68dfe150&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container card-form-container\"},[_c('form',{staticClass:\"card-form\",on:{\"submit\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.submitFile($event)}}},[_c('h2',{staticClass:\"form-title\"},[_vm._t(\"default\")],2),_c('div',[_c('loading',{attrs:{\"id\":\"loading-box\",\"active\":_vm.isLoading,\"can-cancel\":true,\"opacity\":_vm.opacity},on:{\"update:active\":function($event){_vm.isLoading=$event}}})],1),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.isLoading),expression:\"!isLoading\"}],staticClass:\"form-content\"},[_c('div',{staticClass:\"form-item form-name\"},[_c('label',{attrs:{\"for\":\"name\"}},[_vm._v(\"項目名稱*：\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.item.name),expression:\"item.name\"}],attrs:{\"type\":\"text\",\"name\":\"name\",\"id\":\"name\",\"required\":\"\"},domProps:{\"value\":(_vm.item.name)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.item, \"name\", $event.target.value)}}})]),_c('div',{staticClass:\"form-item form-category\"},[_c('label',{attrs:{\"for\":\"category\"}},[_vm._v(\"運動種類*：\")]),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.item.CategoryId),expression:\"item.CategoryId\"}],staticClass:\"category\",attrs:{\"name\":\"CategoryId\",\"id\":\"category\",\"required\":\"\"},on:{\"change\":[function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.$set(_vm.item, \"CategoryId\", $event.target.multiple ? $$selectedVal : $$selectedVal[0])},_vm.filterSubcategory]}},[_c('option',{attrs:{\"value\":\"-1\",\"hidden\":\"\",\"disabled\":\"\"}},[_vm._v(\"請選擇\")]),_vm._l((_vm.categories),function(category){return _c('option',{key:category.id,domProps:{\"value\":category.id}},[_vm._v(_vm._s(category.name))])})],2)]),_c('div',{staticClass:\"form-item form-subcategory\"},[_c('p',[_vm._v(\"運動類別*：\")]),_c('div',{staticClass:\"form-subcategory-wrapper\"},_vm._l((_vm.subcategoryFilter),function(subcategory){return _c('div',{key:subcategory.id,staticClass:\"subcategory-box\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.item.subcategoriesArr),expression:\"item.subcategoriesArr\"}],attrs:{\"type\":\"checkbox\",\"id\":_vm.labelIndex(subcategory.id),\"name\":\"subcategoriesArr\"},domProps:{\"value\":subcategory.id,\"checked\":Array.isArray(_vm.item.subcategoriesArr)?_vm._i(_vm.item.subcategoriesArr,subcategory.id)>-1:(_vm.item.subcategoriesArr)},on:{\"change\":function($event){var $$a=_vm.item.subcategoriesArr,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=subcategory.id,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.$set(_vm.item, \"subcategoriesArr\", $$a.concat([$$v])))}else{$$i>-1&&(_vm.$set(_vm.item, \"subcategoriesArr\", $$a.slice(0,$$i).concat($$a.slice($$i+1))))}}else{_vm.$set(_vm.item, \"subcategoriesArr\", $$c)}}}}),_c('label',{attrs:{\"for\":_vm.labelIndex(subcategory.id)}},[_vm._v(_vm._s(subcategory.name))])])}),0)]),_c('div',{staticClass:\"form-item form-limit\"},[_c('label',{attrs:{\"for\":\"limit\"}},[_vm._v(\"限制：\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.item.limit),expression:\"item.limit\"}],attrs:{\"type\":\"text\",\"name\":\"limit\",\"id\":\"limit\"},domProps:{\"value\":(_vm.item.limit)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.item, \"limit\", $event.target.value)}}})]),_c('div',{staticClass:\"form-item form-description\"},[_c('label',{attrs:{\"for\":\"description\"}},[_vm._v(\"項目描述：\")]),_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.item.description),expression:\"item.description\"}],attrs:{\"name\":\"description\",\"id\":\"description\"},domProps:{\"value\":(_vm.item.description)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.item, \"description\", $event.target.value)}}})]),_c('div',{staticClass:\"form-item form-image\"},[_c('p',{attrs:{\"for\":\"image\"}},[_vm._v(\"相關圖片：\")]),_c('input',{ref:\"inputFile\",attrs:{\"type\":\"file\",\"name\":\"image\"},on:{\"change\":_vm.fileChangeHandler}}),_c('div',{staticClass:\"form-item-image\"},[_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.item.image),expression:\"item.image\"}],attrs:{\"src\":_vm.item.image,\"alt\":\"image\"}})])])]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.isLoading),expression:\"!isLoading\"}],staticClass:\"form-buttons\"},[_c('router-link',{staticClass:\"form-button go-back-button\",attrs:{\"to\":\"/\"}},[_vm._v(\" 回首頁 \")]),(_vm.oriImage)?_c('button',{staticClass:\"form-button delete-image-button\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.deleteImage(_vm.item.id)}}},[_vm._v(\" 只刪除圖片 \")]):_vm._e(),_c('button',{staticClass:\"form-button card-submit-button\",attrs:{\"type\":\"submit\",\"disabled\":_vm.isProcessing}},[_vm._v(\" \"+_vm._s(_vm.isProcessing ? '送出中' : '送出表單')+\" \")])],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"container card-form-container\">\r\n    <form class=\"card-form\" @submit.stop.prevent=\"submitFile\">\r\n      <h2 class=\"form-title\">\r\n        <slot></slot>\r\n      </h2>\r\n      <div>\r\n        <loading\r\n          id=\"loading-box\"\r\n          :active.sync=\"isLoading\"\r\n          :can-cancel=\"true\"\r\n          :opacity=\"opacity\"\r\n        ></loading>\r\n      </div>\r\n      <div class=\"form-content\" v-show=\"!isLoading\">\r\n        <div class=\"form-item form-name\">\r\n          <label for=\"name\">項目名稱*：</label>\r\n          <input\r\n            type=\"text\"\r\n            name=\"name\"\r\n            id=\"name\"\r\n            v-model=\"item.name\"\r\n            required\r\n          />\r\n        </div>\r\n        <div class=\"form-item form-category\">\r\n          <label for=\"category\">運動種類*：</label>\r\n          <select\r\n            name=\"CategoryId\"\r\n            id=\"category\"\r\n            class=\"category\"\r\n            v-model=\"item.CategoryId\"\r\n            required\r\n            @change=\"filterSubcategory\"\r\n          >\r\n            <option value=\"-1\" hidden disabled>請選擇</option>\r\n            <option\r\n              :value=\"category.id\"\r\n              v-for=\"category in categories\"\r\n              :key=\"category.id\"\r\n              >{{ category.name }}</option\r\n            >\r\n          </select>\r\n        </div>\r\n        <div class=\"form-item form-subcategory\">\r\n          <p>運動類別*：</p>\r\n          <div class=\"form-subcategory-wrapper\">\r\n            <div\r\n              class=\"subcategory-box\"\r\n              v-for=\"subcategory in subcategoryFilter\"\r\n              :key=\"subcategory.id\"\r\n            >\r\n              <input\r\n                type=\"checkbox\"\r\n                :id=\"labelIndex(subcategory.id)\"\r\n                v-model=\"item.subcategoriesArr\"\r\n                :value=\"subcategory.id\"\r\n                name=\"subcategoriesArr\"\r\n              />\r\n              <label :for=\"labelIndex(subcategory.id)\">{{\r\n                subcategory.name\r\n              }}</label>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"form-item form-limit\">\r\n          <label for=\"limit\">限制：</label>\r\n          <input type=\"text\" name=\"limit\" id=\"limit\" v-model=\"item.limit\" />\r\n        </div>\r\n        <div class=\"form-item form-description\">\r\n          <label for=\"description\">項目描述：</label>\r\n          <textarea\r\n            name=\"description\"\r\n            id=\"description\"\r\n            v-model=\"item.description\"\r\n          ></textarea>\r\n        </div>\r\n        <div class=\"form-item form-image\">\r\n          <p for=\"image\">相關圖片：</p>\r\n          <input\r\n            type=\"file\"\r\n            @change=\"fileChangeHandler\"\r\n            name=\"image\"\r\n            ref=\"inputFile\"\r\n          />\r\n          <div class=\"form-item-image\">\r\n            <img :src=\"item.image\" alt=\"image\" v-show=\"item.image\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"form-buttons\" v-show=\"!isLoading\">\r\n        <router-link to=\"/\" class=\"form-button go-back-button\">\r\n          回首頁\r\n        </router-link>\r\n        <button\r\n          v-if=\"oriImage\"\r\n          class=\"form-button delete-image-button\"\r\n          @click.stop.prevent=\"deleteImage(item.id)\"\r\n        >\r\n          只刪除圖片\r\n        </button>\r\n        <button\r\n          type=\"submit\"\r\n          class=\"form-button card-submit-button\"\r\n          :disabled=\"isProcessing\"\r\n        >\r\n          {{ isProcessing ? '送出中' : '送出表單' }}\r\n        </button>\r\n      </div>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { Toast, Confirm } from '../utils/helpers'\r\nimport itemsAPI from '../apis/items'\r\nexport default {\r\n  name: 'CardForm',\r\n  data() {\r\n    return {\r\n      opacity: 0,\r\n      subcategoryFilter: [],\r\n      item: {\r\n        image: '',\r\n        CategoryId: -1\r\n      },\r\n      oriImage: undefined,\r\n      categories: [],\r\n      subcategories: []\r\n    }\r\n  },\r\n  props: {\r\n    oriCategories: {\r\n      type: Array\r\n    },\r\n    oriSubcategories: {\r\n      type: Array\r\n    },\r\n    oriItem: {\r\n      type: Object\r\n    },\r\n    isProcessing: {\r\n      type: Boolean\r\n    },\r\n    isLoading: {\r\n      type: Boolean\r\n    },\r\n    formTtpe: {\r\n      type: String\r\n    }\r\n  },\r\n  methods: {\r\n    filterSubcategory() {\r\n      this.item.subcategoriesArr = []\r\n      this.subcategoryFilter = this.subcategories.filter(\r\n        subcategory => subcategory.CategoryId === this.item.CategoryId\r\n      )\r\n    },\r\n    labelIndex(id) {\r\n      return `subcategory-${id}`\r\n    },\r\n    fileChangeHandler(e) {\r\n      const files = e.target.files\r\n      const filetype = ['image/jpeg', 'image/png']\r\n      if (!filetype.includes(files[0].type)) {\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '只能傳圖片唷！'\r\n        })\r\n        this.item.image = ''\r\n        this.$refs.inputFile.value = ''\r\n        return\r\n      }\r\n      if (!files.length) {\r\n        this.item.image = ''\r\n      } else {\r\n        const imageURL = window.URL.createObjectURL(files[0])\r\n        this.item.image = imageURL\r\n      }\r\n    },\r\n    submitFile(e) {\r\n      if (\r\n        !this.item.name ||\r\n        this.item.CategoryId < 0 ||\r\n        this.item.subcategoriesArr.length === 0\r\n      ) {\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '必填欄位要記得填哦！'\r\n        })\r\n        return\r\n      }\r\n      const form = e.target\r\n      const formData = new FormData(form)\r\n      Confirm.fire({\r\n        title: `確定要送出了嗎？若有上傳圖片會花較久時間，請見諒`,\r\n        confirmButtonText: `送出`\r\n      }).then(result => {\r\n        if (result.isConfirmed) {\r\n          this.$emit('submitFile', formData)\r\n        }\r\n      })\r\n    },\r\n    //只有有圖片的項目才有此方法\r\n    async deleteImage(id) {\r\n      try {\r\n        const result = await Confirm.fire({\r\n          title: '確定要刪除圖片嗎？',\r\n          confirmButtonText: `確定`\r\n        })\r\n        if (result.isConfirmed) {\r\n          const { data, statusText } = await itemsAPI.deleteItemImage({\r\n            itemId: id\r\n          })\r\n          if (statusText !== 'OK') {\r\n            throw new Error()\r\n          }\r\n          if (data.status === 'error') {\r\n            Toast.fire({\r\n              icon: 'error',\r\n              title: data.message\r\n            })\r\n            return\r\n          }\r\n          Toast.fire({\r\n            icon: 'success',\r\n            title: '已成功刪除圖片'\r\n          })\r\n          this.$router.push(`/items/${id}`)\r\n        }\r\n      } catch (err) {\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '目前無法刪除圖片，請稍後再試'\r\n        })\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    oriCategories(newValue) {\r\n      this.categories = newValue\r\n    },\r\n    oriSubcategories(newValue) {\r\n      this.subcategories = newValue\r\n      //如果subcategories比item晚進來，就跑下面if\r\n      if (this.subcategoryFilter.length === 0 && this.item.CategoryId !== -1) {\r\n        this.subcategoryFilter = newValue.filter(\r\n          subcategory => subcategory.CategoryId === this.oriItem.CategoryId\r\n        )\r\n      }\r\n    },\r\n    oriItem(newValue) {\r\n      this.item = newValue\r\n      this.oriImage = newValue.image\r\n      //如果items比subcategories晚進來，就跑下面if\r\n      if (\r\n        this.subcategoryFilter.length === 0 &&\r\n        this.subcategories.length !== 0\r\n      ) {\r\n        this.subcategoryFilter = this.subcategories.filter(\r\n          subcategory => subcategory.CategoryId === this.oriItem.CategoryId\r\n        )\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.card-form-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  padding-top: 20px;\r\n  #loading-box {\r\n    margin-top: 10px;\r\n  }\r\n}\r\n.card-form {\r\n  margin: 90px auto 40px auto;\r\n  padding: 10px 20px;\r\n  background-color: $light-logo-green;\r\n  box-shadow: 0 0 2px 2px rgba(0, 0, 0, 0.5);\r\n  border-radius: 10px;\r\n  @include pad {\r\n    max-width: 700px;\r\n    background-color: $op-white;\r\n  }\r\n  h2 {\r\n    border-bottom: 2px solid $dark-gray;\r\n    padding: 20px 0 30px 5px;\r\n    font-weight: 700;\r\n    letter-spacing: 2px;\r\n    text-align: center;\r\n    color: $dark-gray;\r\n  }\r\n  .form-content {\r\n    padding: 0 10px;\r\n    @include pad {\r\n      display: grid;\r\n      grid-template-columns: 1fr 1fr;\r\n    }\r\n    .form-subcategory,\r\n    .form-limit,\r\n    .form-description,\r\n    .form-image {\r\n      @include pad {\r\n        grid-column: 1/3;\r\n      }\r\n    }\r\n    .form-name {\r\n      @include pad {\r\n        padding-right: 30px;\r\n      }\r\n    }\r\n    .form-category {\r\n      .label {\r\n        @include pad {\r\n          display: block;\r\n        }\r\n      }\r\n      select {\r\n        @include pad {\r\n          margin-top: 10px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .form-item {\r\n    padding: 20px 0;\r\n    border-bottom: 1px solid $gray;\r\n    font-size: 1.3rem;\r\n    input[type='text'] {\r\n      margin-top: 10px;\r\n      margin-bottom: 10px;\r\n      width: 100%;\r\n      @extend .input-style;\r\n    }\r\n    select {\r\n      @extend .input-style;\r\n    }\r\n    input[type='checkbox'] {\r\n      display: none;\r\n      ~ label {\r\n        padding: 0 3px;\r\n        margin: 3px;\r\n        border: 2px solid rgba(0, 0, 0, 0.2);\r\n        border-radius: 10px;\r\n        color: rgba(0, 0, 0, 0.2);\r\n        line-height: 2;\r\n      }\r\n      &:checked ~ label {\r\n        border: 2px solid $dark-green;\r\n        color: $dark-green;\r\n      }\r\n    }\r\n    input[type='file'] {\r\n      border-radius: 5px;\r\n      font-size: 1.2rem;\r\n    }\r\n    .form-subcategory-wrapper {\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      margin: 10px;\r\n    }\r\n    textarea {\r\n      margin: 10px 0;\r\n      width: 100%;\r\n      height: 100px;\r\n      font-size: 1.2rem;\r\n      line-height: 1.4;\r\n      resize: none;\r\n      @extend .input-style;\r\n    }\r\n    input[type='file'] {\r\n      margin: 10px 0;\r\n    }\r\n    .form-item-image {\r\n      margin: 10px 0;\r\n      width: 100%;\r\n      img {\r\n        width: 100%;\r\n      }\r\n    }\r\n  }\r\n  .form-buttons {\r\n    display: flex;\r\n    justify-content: space-around;\r\n    padding: 20px 10px 10px 10px;\r\n    .form-button {\r\n      @extend .button-style;\r\n      color: $black;\r\n      font-size: 1.3rem;\r\n      &.go-back-button {\r\n        border: 2px solid $gray;\r\n        &:hover {\r\n          border: 2px solid $dark-gray;\r\n        }\r\n      }\r\n      &.card-submit-button,\r\n      &.delete-image-button {\r\n        border: 2px solid $logo-green;\r\n        background-color: $logo-green;\r\n        &:hover {\r\n          border: 2px solid $dark-green;\r\n        }\r\n        &:disabled {\r\n          cursor: default;\r\n          background-color: $gray;\r\n          border: 2px solid $gray;\r\n          &:hover {\r\n            border: 2px solid $gray;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CardForm.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CardForm.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CardForm.vue?vue&type=template&id=2f3882cc&\"\nimport script from \"./CardForm.vue?vue&type=script&lang=js&\"\nexport * from \"./CardForm.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CardForm.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CardForm.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CardForm.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}