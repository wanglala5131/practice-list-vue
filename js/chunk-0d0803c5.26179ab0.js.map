{"version":3,"sources":["webpack:///./src/views/EditItem.vue?d02c","webpack:///src/views/EditItem.vue","webpack:///./src/views/EditItem.vue?6274","webpack:///./src/views/EditItem.vue","webpack:///./src/views/EditItem.vue?e337","webpack:///./src/components/CardForm.vue?7b1d","webpack:///src/components/CardForm.vue","webpack:///./src/components/CardForm.vue?f110","webpack:///./src/components/CardForm.vue","webpack:///./src/components/CardForm.vue?209b"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","isProcessing","on","$event","categories","subcategories","item","isLoading","submitFileHandler","_v","staticRenderFns","name","components","BackgroundImg","CardForm","data","created","fetchItem","id","fetchCategories","methods","component","staticClass","stopPropagation","preventDefault","submitFile","_t","opacity","directives","rawName","value","expression","domProps","target","composing","$set","$$selectedVal","Array","prototype","filter","call","options","o","selected","map","val","_value","multiple","filterSubcategory","_l","category","key","_s","subcategory","labelIndex","isArray","subcategoriesArr","_i","$$a","$$el","$$c","checked","$$v","$$i","concat","slice","ref","fileChangeHandler","image","deleteImage","_e","subcategoryFilter","CategoryId","oriImage","undefined","props","oriCategories","type","oriSubcategories","oriItem","Object","Boolean","formTtpe","String","filetype","includes","files","icon","title","$refs","inputFile","length","imageURL","confirmButtonText","result","isConfirmed","watch","newValue"],"mappings":"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","file":"js/chunk-0d0803c5.26179ab0.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('main',[_c('BackgroundImg'),_c('div',[_c('loading',{attrs:{\"active\":_vm.isProcessing},on:{\"update:active\":function($event){_vm.isProcessing=$event}}})],1),_c('CardForm',{attrs:{\"ori-categories\":_vm.categories,\"ori-subcategories\":_vm.subcategories,\"ori-item\":_vm.item,\"is-processing\":_vm.isProcessing,\"is-loading\":_vm.isLoading,\"form-type\":'edit'},on:{\"submitFile\":_vm.submitFileHandler}},[_vm._v(\"修改項目\")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <main>\r\n    <BackgroundImg />\r\n    <div>\r\n      <loading :active.sync=\"isProcessing\"></loading>\r\n    </div>\r\n    <CardForm\r\n      :ori-categories=\"categories\"\r\n      :ori-subcategories=\"subcategories\"\r\n      :ori-item=\"item\"\r\n      :is-processing=\"isProcessing\"\r\n      :is-loading=\"isLoading\"\r\n      :form-type=\"'edit'\"\r\n      @submitFile=\"submitFileHandler\"\r\n      >修改項目</CardForm\r\n    >\r\n  </main>\r\n</template>\r\n\r\n<script>\r\nimport BackgroundImg from '../components/BackgroundImg'\r\nimport CardForm from '../components/CardForm'\r\nimport settingAPI from '../apis/setting'\r\nimport itemsAPI from '../apis/items'\r\nimport { Toast } from '../utils/helpers'\r\nexport default {\r\n  name: 'EditItem',\r\n  components: {\r\n    BackgroundImg,\r\n    CardForm\r\n  },\r\n  data() {\r\n    return {\r\n      isLoading: true,\r\n      isProcessing: false,\r\n      categories: [],\r\n      subcategories: [],\r\n      item: {}\r\n    }\r\n  },\r\n  created() {\r\n    const { id } = this.$route.params\r\n    this.fetchItem(id)\r\n    this.fetchCategories()\r\n  },\r\n  methods: {\r\n    async fetchCategories() {\r\n      try {\r\n        const { data, statusText } = await settingAPI.getSubcategory()\r\n        if (statusText !== 'OK') {\r\n          throw new Error()\r\n        }\r\n        this.categories = data.categories\r\n        this.subcategories = data.subcategories\r\n        this.isLoading = false\r\n      } catch (err) {\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '目前無法取得運動項目與運動類別，請稍後再試'\r\n        })\r\n      }\r\n    },\r\n    async fetchItem(itemId) {\r\n      try {\r\n        const { data, statusText } = await itemsAPI.getItem({ itemId })\r\n        if (statusText !== 'OK') {\r\n          throw new Error()\r\n        }\r\n        if (data.status === 'error') {\r\n          Toast.fire({\r\n            icon: 'error',\r\n            title: data.message\r\n          })\r\n          return\r\n        }\r\n        const subcategoriesArr = []\r\n        data.item.Subcategories.map(subcategory => {\r\n          subcategoriesArr.push(subcategory.id)\r\n        })\r\n        this.item = { ...data.item, subcategoriesArr: subcategoriesArr }\r\n        return\r\n      } catch (err) {\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '目前無法取得項目資料，請稍後再試'\r\n        })\r\n      }\r\n    },\r\n    async submitFileHandler(formData) {\r\n      try {\r\n        this.isProcessing = true\r\n        const itemId = this.item.id\r\n        const { data, statusText } = await itemsAPI.putItem({\r\n          itemId,\r\n          formData\r\n        })\r\n        if (statusText !== 'OK') {\r\n          throw new Error()\r\n        }\r\n        if (data.status === 'error') {\r\n          Toast.fire({\r\n            icon: 'error',\r\n            title: data.message\r\n          })\r\n          this.isProcessing = false\r\n          return\r\n        }\r\n        Toast.fire({\r\n          icon: 'success',\r\n          title: '成功編輯項目'\r\n        })\r\n        const { updateItem } = data\r\n        this.$router.push(`/items/${updateItem.id}`)\r\n      } catch (err) {\r\n        this.isProcessing = false\r\n        console.log(err)\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '目前暫時無法編輯項目，請稍後再試'\r\n        })\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.bg-img {\r\n  display: none;\r\n  @include pad {\r\n    display: block;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditItem.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditItem.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./EditItem.vue?vue&type=template&id=144201f7&scoped=true&\"\nimport script from \"./EditItem.vue?vue&type=script&lang=js&\"\nexport * from \"./EditItem.vue?vue&type=script&lang=js&\"\nimport style0 from \"./EditItem.vue?vue&type=style&index=0&id=144201f7&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"144201f7\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditItem.vue?vue&type=style&index=0&id=144201f7&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./EditItem.vue?vue&type=style&index=0&id=144201f7&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container card-form-container\"},[_c('form',{staticClass:\"card-form\",on:{\"submit\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.submitFile($event)}}},[_c('h2',{staticClass:\"form-title\"},[_vm._t(\"default\")],2),_c('div',[_c('loading',{attrs:{\"id\":\"loading-box\",\"active\":_vm.isLoading,\"can-cancel\":true,\"opacity\":_vm.opacity},on:{\"update:active\":function($event){_vm.isLoading=$event}}})],1),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.isLoading),expression:\"!isLoading\"}],staticClass:\"form-content\"},[_c('div',{staticClass:\"form-item form-name\"},[_c('label',{attrs:{\"for\":\"name\"}},[_vm._v(\"項目名稱*：\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.item.name),expression:\"item.name\"}],attrs:{\"type\":\"text\",\"name\":\"name\",\"id\":\"name\",\"required\":\"\"},domProps:{\"value\":(_vm.item.name)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.item, \"name\", $event.target.value)}}})]),_c('div',{staticClass:\"form-item form-category\"},[_c('label',{attrs:{\"for\":\"category\"}},[_vm._v(\"運動種類*：\")]),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.item.CategoryId),expression:\"item.CategoryId\"}],staticClass:\"category\",attrs:{\"name\":\"CategoryId\",\"id\":\"category\",\"required\":\"\"},on:{\"change\":[function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.$set(_vm.item, \"CategoryId\", $event.target.multiple ? $$selectedVal : $$selectedVal[0])},_vm.filterSubcategory]}},[_c('option',{attrs:{\"value\":\"-1\",\"hidden\":\"\",\"disabled\":\"\"}},[_vm._v(\"請選擇\")]),_vm._l((_vm.categories),function(category){return _c('option',{key:category.id,domProps:{\"value\":category.id}},[_vm._v(_vm._s(category.name))])})],2)]),_c('div',{staticClass:\"form-item form-subcategory\"},[_c('p',[_vm._v(\"運動類別*：\")]),_c('div',{staticClass:\"form-subcategory-wrapper\"},_vm._l((_vm.subcategoryFilter),function(subcategory){return _c('div',{key:subcategory.id,staticClass:\"subcategory-box\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.item.subcategoriesArr),expression:\"item.subcategoriesArr\"}],attrs:{\"type\":\"checkbox\",\"id\":_vm.labelIndex(subcategory.id),\"name\":\"subcategoriesArr\"},domProps:{\"value\":subcategory.id,\"checked\":Array.isArray(_vm.item.subcategoriesArr)?_vm._i(_vm.item.subcategoriesArr,subcategory.id)>-1:(_vm.item.subcategoriesArr)},on:{\"change\":function($event){var $$a=_vm.item.subcategoriesArr,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=subcategory.id,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.$set(_vm.item, \"subcategoriesArr\", $$a.concat([$$v])))}else{$$i>-1&&(_vm.$set(_vm.item, \"subcategoriesArr\", $$a.slice(0,$$i).concat($$a.slice($$i+1))))}}else{_vm.$set(_vm.item, \"subcategoriesArr\", $$c)}}}}),_c('label',{attrs:{\"for\":_vm.labelIndex(subcategory.id)}},[_vm._v(_vm._s(subcategory.name))])])}),0)]),_c('div',{staticClass:\"form-item form-limit\"},[_c('label',{attrs:{\"for\":\"limit\"}},[_vm._v(\"限制：\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.item.limit),expression:\"item.limit\"}],attrs:{\"type\":\"text\",\"name\":\"limit\",\"id\":\"limit\"},domProps:{\"value\":(_vm.item.limit)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.item, \"limit\", $event.target.value)}}})]),_c('div',{staticClass:\"form-item form-description\"},[_c('label',{attrs:{\"for\":\"description\"}},[_vm._v(\"項目描述：\")]),_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.item.description),expression:\"item.description\"}],attrs:{\"name\":\"description\",\"id\":\"description\"},domProps:{\"value\":(_vm.item.description)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.item, \"description\", $event.target.value)}}})]),_c('div',{staticClass:\"form-item form-image\"},[_c('p',{attrs:{\"for\":\"image\"}},[_vm._v(\"相關圖片：\")]),_c('input',{ref:\"inputFile\",attrs:{\"type\":\"file\",\"name\":\"image\"},on:{\"change\":_vm.fileChangeHandler}}),_c('div',{staticClass:\"form-item-image\"},[_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.item.image),expression:\"item.image\"}],attrs:{\"src\":_vm.item.image,\"alt\":\"image\"}})])])]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.isLoading),expression:\"!isLoading\"}],staticClass:\"form-buttons\"},[_c('router-link',{staticClass:\"form-button go-back-button\",attrs:{\"to\":\"/\"}},[_vm._v(\" 回首頁 \")]),(_vm.oriImage)?_c('button',{staticClass:\"form-button delete-image-button\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.deleteImage(_vm.item.id)}}},[_vm._v(\" 只刪除圖片 \")]):_vm._e(),_c('button',{staticClass:\"form-button card-submit-button\",attrs:{\"type\":\"submit\",\"disabled\":_vm.isProcessing}},[_vm._v(\" \"+_vm._s(_vm.isProcessing ? '送出中' : '送出表單')+\" \")])],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"container card-form-container\">\r\n    <form class=\"card-form\" @submit.stop.prevent=\"submitFile\">\r\n      <h2 class=\"form-title\">\r\n        <slot></slot>\r\n      </h2>\r\n      <div>\r\n        <loading\r\n          id=\"loading-box\"\r\n          :active.sync=\"isLoading\"\r\n          :can-cancel=\"true\"\r\n          :opacity=\"opacity\"\r\n        ></loading>\r\n      </div>\r\n      <div class=\"form-content\" v-show=\"!isLoading\">\r\n        <div class=\"form-item form-name\">\r\n          <label for=\"name\">項目名稱*：</label>\r\n          <input\r\n            type=\"text\"\r\n            name=\"name\"\r\n            id=\"name\"\r\n            v-model=\"item.name\"\r\n            required\r\n          />\r\n        </div>\r\n        <div class=\"form-item form-category\">\r\n          <label for=\"category\">運動種類*：</label>\r\n          <select\r\n            name=\"CategoryId\"\r\n            id=\"category\"\r\n            class=\"category\"\r\n            v-model=\"item.CategoryId\"\r\n            required\r\n            @change=\"filterSubcategory\"\r\n          >\r\n            <option value=\"-1\" hidden disabled>請選擇</option>\r\n            <option\r\n              :value=\"category.id\"\r\n              v-for=\"category in categories\"\r\n              :key=\"category.id\"\r\n              >{{ category.name }}</option\r\n            >\r\n          </select>\r\n        </div>\r\n        <div class=\"form-item form-subcategory\">\r\n          <p>運動類別*：</p>\r\n          <div class=\"form-subcategory-wrapper\">\r\n            <div\r\n              class=\"subcategory-box\"\r\n              v-for=\"subcategory in subcategoryFilter\"\r\n              :key=\"subcategory.id\"\r\n            >\r\n              <input\r\n                type=\"checkbox\"\r\n                :id=\"labelIndex(subcategory.id)\"\r\n                v-model=\"item.subcategoriesArr\"\r\n                :value=\"subcategory.id\"\r\n                name=\"subcategoriesArr\"\r\n              />\r\n              <label :for=\"labelIndex(subcategory.id)\">{{\r\n                subcategory.name\r\n              }}</label>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"form-item form-limit\">\r\n          <label for=\"limit\">限制：</label>\r\n          <input type=\"text\" name=\"limit\" id=\"limit\" v-model=\"item.limit\" />\r\n        </div>\r\n        <div class=\"form-item form-description\">\r\n          <label for=\"description\">項目描述：</label>\r\n          <textarea\r\n            name=\"description\"\r\n            id=\"description\"\r\n            v-model=\"item.description\"\r\n          ></textarea>\r\n        </div>\r\n        <div class=\"form-item form-image\">\r\n          <p for=\"image\">相關圖片：</p>\r\n          <input\r\n            type=\"file\"\r\n            @change=\"fileChangeHandler\"\r\n            name=\"image\"\r\n            ref=\"inputFile\"\r\n          />\r\n          <div class=\"form-item-image\">\r\n            <img :src=\"item.image\" alt=\"image\" v-show=\"item.image\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"form-buttons\" v-show=\"!isLoading\">\r\n        <router-link to=\"/\" class=\"form-button go-back-button\">\r\n          回首頁\r\n        </router-link>\r\n        <button\r\n          v-if=\"oriImage\"\r\n          class=\"form-button delete-image-button\"\r\n          @click.stop.prevent=\"deleteImage(item.id)\"\r\n        >\r\n          只刪除圖片\r\n        </button>\r\n        <button\r\n          type=\"submit\"\r\n          class=\"form-button card-submit-button\"\r\n          :disabled=\"isProcessing\"\r\n        >\r\n          {{ isProcessing ? '送出中' : '送出表單' }}\r\n        </button>\r\n      </div>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { Toast, Confirm } from '../utils/helpers'\r\nimport itemsAPI from '../apis/items'\r\nexport default {\r\n  name: 'CardForm',\r\n  data() {\r\n    return {\r\n      opacity: 0,\r\n      subcategoryFilter: [],\r\n      item: {\r\n        image: '',\r\n        CategoryId: -1\r\n      },\r\n      oriImage: undefined,\r\n      categories: [],\r\n      subcategories: []\r\n    }\r\n  },\r\n  props: {\r\n    oriCategories: {\r\n      type: Array\r\n    },\r\n    oriSubcategories: {\r\n      type: Array\r\n    },\r\n    oriItem: {\r\n      type: Object\r\n    },\r\n    isProcessing: {\r\n      type: Boolean\r\n    },\r\n    isLoading: {\r\n      type: Boolean\r\n    },\r\n    formTtpe: {\r\n      type: String\r\n    }\r\n  },\r\n  methods: {\r\n    filterSubcategory() {\r\n      this.item.subcategoriesArr = []\r\n      this.subcategoryFilter = this.subcategories.filter(\r\n        subcategory => subcategory.CategoryId === this.item.CategoryId\r\n      )\r\n    },\r\n    labelIndex(id) {\r\n      return `subcategory-${id}`\r\n    },\r\n    fileChangeHandler(e) {\r\n      const files = e.target.files\r\n      const filetype = ['image/jpeg', 'image/png']\r\n      if (!filetype.includes(files[0].type)) {\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '只能傳圖片唷！'\r\n        })\r\n        this.item.image = ''\r\n        this.$refs.inputFile.value = ''\r\n        return\r\n      }\r\n      if (!files.length) {\r\n        this.item.image = ''\r\n      } else {\r\n        const imageURL = window.URL.createObjectURL(files[0])\r\n        this.item.image = imageURL\r\n      }\r\n    },\r\n    submitFile(e) {\r\n      if (\r\n        !this.item.name ||\r\n        this.item.CategoryId < 0 ||\r\n        this.item.subcategoriesArr.length === 0\r\n      ) {\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '必填欄位要記得填哦！'\r\n        })\r\n        return\r\n      }\r\n      const form = e.target\r\n      const formData = new FormData(form)\r\n      Confirm.fire({\r\n        title: `確定要送出了嗎？若有上傳圖片會花較久時間，請見諒`,\r\n        confirmButtonText: `送出`\r\n      }).then(result => {\r\n        if (result.isConfirmed) {\r\n          this.$emit('submitFile', formData)\r\n        }\r\n      })\r\n    },\r\n    //只有有圖片的項目才有此方法\r\n    async deleteImage(id) {\r\n      try {\r\n        const result = await Confirm.fire({\r\n          title: '確定要刪除圖片嗎？',\r\n          confirmButtonText: `確定`\r\n        })\r\n        if (result.isConfirmed) {\r\n          const { data, statusText } = await itemsAPI.deleteItemImage({\r\n            itemId: id\r\n          })\r\n          if (statusText !== 'OK') {\r\n            throw new Error()\r\n          }\r\n          if (data.status === 'error') {\r\n            Toast.fire({\r\n              icon: 'error',\r\n              title: data.message\r\n            })\r\n            return\r\n          }\r\n          Toast.fire({\r\n            icon: 'success',\r\n            title: '已成功刪除圖片'\r\n          })\r\n          this.$router.push(`/items/${id}`)\r\n        }\r\n      } catch (err) {\r\n        Toast.fire({\r\n          icon: 'error',\r\n          title: '目前無法刪除圖片，請稍後再試'\r\n        })\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    oriCategories(newValue) {\r\n      this.categories = newValue\r\n    },\r\n    oriSubcategories(newValue) {\r\n      this.subcategories = newValue\r\n      //如果subcategories比item晚進來，就跑下面if\r\n      if (this.subcategoryFilter.length === 0 && this.item.CategoryId !== -1) {\r\n        this.subcategoryFilter = newValue.filter(\r\n          subcategory => subcategory.CategoryId === this.oriItem.CategoryId\r\n        )\r\n      }\r\n    },\r\n    oriItem(newValue) {\r\n      this.item = newValue\r\n      this.oriImage = newValue.image\r\n      //如果items比subcategories晚進來，就跑下面if\r\n      if (\r\n        this.subcategoryFilter.length === 0 &&\r\n        this.subcategories.length !== 0\r\n      ) {\r\n        this.subcategoryFilter = this.subcategories.filter(\r\n          subcategory => subcategory.CategoryId === this.oriItem.CategoryId\r\n        )\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.card-form-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  padding-top: 20px;\r\n  #loading-box {\r\n    margin-top: 10px;\r\n  }\r\n}\r\n.card-form {\r\n  margin: 90px auto 40px auto;\r\n  padding: 10px 20px;\r\n  background-color: $light-logo-green;\r\n  box-shadow: 0 0 2px 2px rgba(0, 0, 0, 0.5);\r\n  border-radius: 10px;\r\n  @include pad {\r\n    max-width: 700px;\r\n    background-color: $op-white;\r\n  }\r\n  h2 {\r\n    border-bottom: 2px solid $dark-gray;\r\n    padding: 20px 0 30px 5px;\r\n    font-weight: 700;\r\n    letter-spacing: 2px;\r\n    text-align: center;\r\n    color: $dark-gray;\r\n  }\r\n  .form-content {\r\n    padding: 0 10px;\r\n    @include pad {\r\n      display: grid;\r\n      grid-template-columns: 1fr 1fr;\r\n    }\r\n    .form-subcategory,\r\n    .form-limit,\r\n    .form-description,\r\n    .form-image {\r\n      @include pad {\r\n        grid-column: 1/3;\r\n      }\r\n    }\r\n    .form-name {\r\n      @include pad {\r\n        padding-right: 30px;\r\n      }\r\n    }\r\n    .form-category {\r\n      .label {\r\n        @include pad {\r\n          display: block;\r\n        }\r\n      }\r\n      select {\r\n        @include pad {\r\n          margin-top: 10px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .form-item {\r\n    padding: 20px 0;\r\n    border-bottom: 1px solid $gray;\r\n    font-size: 1.3rem;\r\n    input[type='text'] {\r\n      margin-top: 10px;\r\n      margin-bottom: 10px;\r\n      width: 100%;\r\n      @extend .input-style;\r\n    }\r\n    select {\r\n      @extend .input-style;\r\n    }\r\n    input[type='checkbox'] {\r\n      display: none;\r\n      ~ label {\r\n        padding: 0 3px;\r\n        margin: 3px;\r\n        border: 2px solid rgba(0, 0, 0, 0.2);\r\n        border-radius: 10px;\r\n        color: rgba(0, 0, 0, 0.2);\r\n        line-height: 2;\r\n      }\r\n      &:checked ~ label {\r\n        border: 2px solid $dark-green;\r\n        color: $dark-green;\r\n      }\r\n    }\r\n    input[type='file'] {\r\n      border-radius: 5px;\r\n      font-size: 1.2rem;\r\n    }\r\n    .form-subcategory-wrapper {\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      margin: 10px;\r\n    }\r\n    textarea {\r\n      margin: 10px 0;\r\n      width: 100%;\r\n      height: 100px;\r\n      font-size: 1.2rem;\r\n      line-height: 1.4;\r\n      resize: none;\r\n      @extend .input-style;\r\n    }\r\n    input[type='file'] {\r\n      margin: 10px 0;\r\n    }\r\n    .form-item-image {\r\n      margin: 10px 0;\r\n      width: 100%;\r\n      img {\r\n        width: 100%;\r\n      }\r\n    }\r\n  }\r\n  .form-buttons {\r\n    display: flex;\r\n    justify-content: space-around;\r\n    padding: 20px 10px 10px 10px;\r\n    .form-button {\r\n      @extend .button-style;\r\n      color: $black;\r\n      font-size: 1.3rem;\r\n      &.go-back-button {\r\n        border: 2px solid $gray;\r\n        &:hover {\r\n          border: 2px solid $dark-gray;\r\n        }\r\n      }\r\n      &.card-submit-button,\r\n      &.delete-image-button {\r\n        border: 2px solid $logo-green;\r\n        background-color: $logo-green;\r\n        &:hover {\r\n          border: 2px solid $dark-green;\r\n        }\r\n        &:disabled {\r\n          cursor: default;\r\n          background-color: $gray;\r\n          border: 2px solid $gray;\r\n          &:hover {\r\n            border: 2px solid $gray;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CardForm.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CardForm.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CardForm.vue?vue&type=template&id=2f3882cc&\"\nimport script from \"./CardForm.vue?vue&type=script&lang=js&\"\nexport * from \"./CardForm.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CardForm.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CardForm.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CardForm.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}